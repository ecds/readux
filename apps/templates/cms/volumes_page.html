{% extends "base.html" %}
{% load wagtailcore_tags %}
{% load static %}

{% block body_class %}template-homepage{% endblock %}

{% block content %}

<div class="rx-head-container">
  <div class="rx-title-container">
    <ul class="rx-breadcrumb uk-text-truncate">
      <li class="rx-breadcrumb-item"><a href="/" alt="Home">Home</a></li>
      <li class="rx-breadcrumb-item">Volumes</li>
    </ul>

    <div class="rx-title">{{ page.page_title }}</div>
    <div class="rx-title-tagline">{{page.tagline}}</div>
  </div>

  <p>{{ page.paragraph }}</p>
</div>

{% include "snippets/sort_dropdown.html" %}

{% if page.layout == 'Grid' %}
<div id="wrap">
  {% for volume in volumespage %}
  {% if volume.canvas_set.first.pid is null %}
  <div id="box">
    <div id="boxInner">
      <v-volume-image></v-volume-image>
      <div id="innerContent">
        <p>
          <p>{{ volume.label|truncatechars:200 }}</p>
        </p>
        <p><em>Author:</em> {{volume.author|truncatechars:150}}<br />
          <em>Date Published:</em> {{volume.published_date}}<br />
          Added {{volume.created_at}}</p>
      </div>
    </div>
  </div>
  {% else %}
  <div id="box">
    <div id="boxInner">
      <a class="nav-link" href="{% url 'page' volume.pid volume.canvas_set.first.pid %}">
        {% for canvas in volume.canvas_set.all %}
        {% if canvas.is_starting_page == 1 %}
          <v-volume-image src-first="{{ canvas.thumbnail_crop_volume }}" is-starting-page="{{canvas.is_starting_page}}"
            src-last="{{ volume.canvas_set.first.thumbnail_crop_volume }}" is-last-item="{{forloop.last|yesno}}"
            volume-label="{{volume.label}}"></v-volume-image>
        {% elif forloop.last %}
          <v-volume-image src-first="{{ canvas.thumbnail_crop_volume }}" is-starting-page="{{canvas.is_starting_page}}"
            src-last="{{ volume.canvas_set.first.thumbnail_crop_volume }}" is-last-item="{{forloop.last|yesno}}"
            volume-label="{{volume.label}}"></v-volume-image>
        {% endif %}
        {% endfor %}

      </a>
      <div id="innerContent">
        <p>
          <a class="nav-link" href="{% url 'page' volume.pid volume.canvas_set.first.pid %}">
            <p>{{ volume.label|truncatechars:200 }}</p>
          </a></p>
        <p><em>Author:</em> {{volume.author|truncatechars:150}}<br />
          <em>Date Published:</em> {{volume.published_date}}<br />
          Added {{volume.created_at}}</p>
      </div>
    </div>
  </div>
  {% endif %}
  {% endfor %}
</div>
{% endif %}

{% if page.layout == 'List' %}

<div class="uk-grid-match uk-child-width-expand@s uk-grid-large" uk-grid>
  {% for volume in volumespage %}
  {% if volume.canvas_set.first.pid is null %}
  <div class="uk-width-1-2@m uk-grid-medium">
    <div class="uk-width-1-4@m rx-volume-image">
      <a class="nav-link" href="#">
        <v-volume-image></v-volume-image>
      </a>
    </div>
    <div class="uk-width-3-4@m">
      <a class="nav-link" href="#">
        <h3 class="rx-card-title uk-margin-remove-bottom">{{ volume.label|truncatechars:100 }}</h3>
      </a>
      <ul class="uk-padding-remove uk-margin-remove">
        <li>Author: {{volume.author|truncatechars:150}}</li>
        <li>Published: {{volume.published_date}}</li>
        <li>Added: {{volume.created_at}}</li>
      </ul>
    </div>
  </div>
  {% else %}
  <div class="uk-width-1-2@m uk-grid-medium">

    <div class="uk-width-1-4@m rx-volume-image">
      <a class="nav-link" href="{% url 'page' volume.pid volume.canvas_set.first.pid %}">
        {% for canvas in volume.canvas_set.all %}
          {% if canvas.is_starting_page == 1 %}
          <v-volume-image 
          src-first="{{ canvas.thumbnail_crop_volume }}" 
          is-starting-page="{{canvas.is_starting_page}}"
          src-last="{{ volume.canvas_set.first.thumbnail_crop_volume }}"
          is-last-item="{{forloop.last|yesno}}"
          volume-label="{{volume.label}}"></v-volume-image>
          {% elif forloop.last %}
          <v-volume-image 
          src-first="{{ canvas.thumbnail_crop_volume }}" 
          is-starting-page="{{canvas.is_starting_page}}"
          src-last="{{ volume.canvas_set.first.thumbnail_crop_volume }}"
          is-last-item="{{forloop.last|yesno}}"
          volume-label="{{volume.label}}"></v-volume-image>
          {% endif %}
        {% endfor %}
      </a>
    </div>
    <div class="uk-width-3-4@m">
      <a class="nav-link" href="{% url 'page' volume.pid volume.canvas_set.first.pid %}">
        <h3 class="rx-card-title uk-margin-remove-bottom">{{ volume.label|truncatechars:100 }}</h3>
      </a>
      <ul class="uk-padding-remove uk-margin-remove rx-card-text">
        <li>Author: {{volume.author|truncatechars:150}}</li>
        <li>Published: {{volume.published_date}} | Added: {{volume.created_at}}</li>
      </ul>
    </div>
  </div>
  {% endif %}
  {% endfor %}
</div>

{% endif %}

{% endblock content %}