{% extends "base.html" %}
{% load static %}
{% block content %}
<div class="uk-container">
<header class="page-header" id="page-bg">
  <div class="container">
<img src="/media/{{collection.header}}" alt="Header image for collection {{collection.label}}" style="width:100%;" />
  </div>
<div class="collection-image-info collasped">

        <h3>{{ collection.collection_image_title }}</h3>
        <div class="info"> {% if collection.collection_image_summary %}
          <p>{{ collection.collection_image_summary }}</p> {% endif %}
          <p class="small credit">{{ collection.collection_image_creator }}</p>
        </div>
  </div>
<div class="collection-label"><h1><span>{{ collection.label }}</span></h1></div>
</header>
<p>{{ collection.summary }}</p>
<h2>{{volumes|length}} volume{{volumes|length|pluralize}} in this collection</h2>

{% include "snippets/sort_dropdown.html" %}
<!--TODO: include ascending/descending sort feature-->

<div class="uk-container">
{% for volume in volumes %}


{% if volume.canvas_set.first.pid is null %}
<div><div id="grid"><div id="grid-image-volume">
    <img src='{% static 'images/image_not_found.jpg' %}'/>
  </div><div id="grid-metaforimage"><p>
  {{ volume.label }} 
 {% for value in user_annotation_count %}
 {% if volume.pid in value %}
 {% if "0" not in value|safe|slice:"-3:-1" %}
<!-- 
 <button style="background-color:green;color:white;"> {{ value|safe|slice:"-3:-1" }} </button>
 -->
 <span class="count-icon">
 <span class="uk-icon" uk-icon="icon: comments; ratio: 1.5" uk-tooltip="title: Number of your annotations; pos: bottom"></span>
 <span class="count">{{ value|safe|slice:"-3:-1" }}</span>
 </span>
 {% endif %}
 {% endif %}
 {% endfor %}
<br/>
Author: {{volume.author}}<br/>
Date: {{volume.published_date}}<br/>
Publisher: {{volume.publisher}}<br/>
Publication City: {{volume.published_city}}</p>
  </div></div>
{% else %}
<div><div id="grid"><div id="grid-image-volume">
  <a class="nav-link" href="{% url 'page' volume.pid volume.canvas_set.first.pid %}">
    {% for canvas in volume.canvas_set.all %}{% if canvas.is_starting_page == 1 %}<img src="{{ canvas.thumbnail }}" {% elif forloop.last %}<img src="{{ volume.canvas_set.first.thumbnail }}"{% endif %}{% endfor %} alt="First page of {{volume.label}}" onerror="this.onerror=null;this.src='{% static 'images/image_not_found.jpg' %}';"/>
  </a>
  </div><div id="grid-metaforimage"><p>
    <a class="nav-link" href="{% url 'page' volume.pid volume.canvas_set.first.pid %}">
  {{ volume.label }}
</a>
 {% for value in user_annotation_count %}
 {% if volume.pid in value %}
 {% if "0" not in value|safe|slice:"-3:-1" %}
<!-- 
 <button style="background-color:green;color:white;"> {{ value|safe|slice:"-3:-1" }} </button>
 -->
 <span class="count-icon">
 <span class="uk-icon" uk-icon="icon: comments; ratio: 1.5" uk-tooltip="title: Number of your annotations; pos: bottom"></span>
 <span class="count">{{ value|safe|slice:"-3:-1" }}</span>
 </span>
 {% endif %}
 {% endif %}
 {% endfor %}

<br/>
Author: {{volume.author}}<br/>
Date: {{volume.published_date}}<br/>
Publisher: {{volume.publisher}}<br/>
Publication City: {{volume.published_city}}</p>
  </div></div>
  {% endif %}
{% endfor %}


</div>
</div>

{% endblock content %}
